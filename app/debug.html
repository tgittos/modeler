<!doctype html>
<html>
  <head>
    <title>Modeller - DEBUG</title>
    <style>
      body{ margin: 0; padding: 0; }
      #debugger { 
        position: absolute; 
        right: 0; 
        width: 350px; 
        height: 100%; 
        border-left: solid 1px;
        font-family: Consolas, monospace;
        font-size: 10px;
        overflow: auto;
      }
      #debugger p {
        border-bottom: solid 1px;
        padding: 3px;
        margin: 0;
      }
      #debugger .debug-log {
        background: #eeeeff;
      }
      #debugger .debug-warn {
        background: #f5f5dc;
      }
      #debugger .debug-error {
        background: #ffc7c7;
      }
    </style>
    <script type="text/javascript" src="../lib/sylvester.src.js"></script>
    <script type="text/javascript" src="../lib/glUtils.js"></script>
    <script type="text/javascript" src="../src/Modeler.js"></script>
    <script type="text/javascript" src="../src/core/Utils.js"></script>
    <script type="text/javascript" src="../src/core/Vertex.js"></script>
    <script type="text/javascript" src="../src/core/Face3.js"></script>
    <script type="text/javascript" src="../src/core/Face4.js"></script>
    <script type="text/javascript" src="../src/core/Geometry.js"></script>
    <script type="text/javascript" src="../src/core/Mesh.js"></script>
    <script type="text/javascript" src="../src/primitives/Cube.js"></script>
    <script type="text/javascript" src="../src/materials/Basic.js"></script>
    <script type="text/javascript" src="../src/core/Scene.js"></script>
    <script type="text/javascript" src="../src/core/Camera.js"></script>
    <script type="text/javascript" src="../src/core/Object3D.js"></script>
    <script type="text/javascript" src="../src/core/Shader.js"></script>
    <script type="text/javascript" src="../src/renderer/WebGLRenderer.js"></script>
    <script type="text/javascript" src="../src/debug/Debugger.js"></script>
    <script id="shader-fs" type="x-shader/x-fragment">
      #ifdef GL_ES
      precision highp float;
      #endif

      varying vec4 vColor;

      void main(void) {
        gl_FragColor = vColor;
      }
    </script>
    <script id="shader-vs" type="x-shader/x-vertex">
      attribute vec3 aVertexPosition;
      attribute vec4 aVertexColor;

      uniform mat4 uMVMatrix;
      uniform mat4 uPMatrix;

      varying vec4 vColor;

      void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vColor = aVertexColor;
      }
    </script>
    <!--script type="text/javascript" src="demos/rotating-objects.js" -->
    <script type="text/javascript">
    function pageLoaded() {

      //DEBUG ONLY
      //$C = new MODELER.Debugger( { force: true } );
      //END DEBUG

      var scene = MODELER.Scene();
      var camera = MODELER.Camera();

      //Send some geometry to the scene
      /*
      var tri = MODELER.Face3({
        vertices: [
          [0.0,  1.0,  1.0],
          [-1.0, -1.0,  1.0],
          [1.0, -1.0,  1.0]
        ]
      });
      var tri_mesh = MODELER.Mesh({
        geometry: tri,
        material: MODELER.Materials.Basic({ 
          colour: [1, 0, 0, 1],
          wireframe: false 
        })
      });
      var tri_model = new MODELER.Object3D({
        meshes: [tri_mesh],
        x: -1.5,
        y: 0.0,
        z: -7.0
      });
      scene.addChild(tri_model);
      */
      var quad = MODELER.Face4({
        vertices: [
          [-1.0, -1.0,  1.0],
          [1.0, -1.0,  1.0],
          [1.0,  1.0,  1.0],
          [-1.0,  1.0,  1.0]
        ]
      });
      var quad_mesh = MODELER.Mesh({
        geometry: quad,
        material: MODELER.Materials.Basic({
          color: [0, 0, 1, 1],
          wireframe: false
        })
      });
      var quad_model = new MODELER.Object3D({
        meshes: [quad_mesh],
        x: -1.5, y: 0.0, z: -7.0,
        rotVector: [1, 1, 0],
        rotDegrees: 45
      });
      scene.addChild(quad_model);
      var quad_render_obj = quad_model.getForRender();
      
      var cube = MODELER.Cube({
        width: 2, height: 2, depth: 2,
        x: 1.5, y: 0.0, z: -7.0,
        rotVector: [1, 1, 0],
        rotDegrees: 45,
        material: MODELER.Materials.Basic({ wireframe: false })
      });
      var cube_render_obj = cube.getForRender();
      scene.addChild(cube);

      var renderer = MODELER.WebGLRenderer( { scene: scene, camera: camera} );

      //Render loop
      var lastTime = 0;
      (function render() {
        var timeNow = new Date().getTime();
        if (lastTime != 0) {
          var elapsed = timeNow - lastTime;
          
          //Do rendering magicks
          cube.rotDegrees += (90 * elapsed) / 1000.0;
          
        }
        lastTime = timeNow;
        
        renderer.render();
        requestAnimationFrame(render);
      })();
    }
    window.onload = pageLoaded;
    </script>
  </head>
  <body>
  </body>
</html>
